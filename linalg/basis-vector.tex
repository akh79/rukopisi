\documentclass[a4paper]{article}
\usepackage{amsmath, amsfonts}
\usepackage{indentfirst}
\usepackage[main=russian,english]{babel}
\usepackage{fontspec}
\setmainfont{Times New Roman}

\author{Андрей Хрузин}
\title{Векторы, базисы и преобразования}

\begin{document}

\maketitle

\section{Введение}
В приложениях геометрии часто приходится иметь дело одновременно со многими базисами и их преобразованиями. Программные пакеты геометрических вычислений используют различные соглашения относительно представления векторов и матриц. При этом базисы, как правило, не указываются в явном виде, что затрудняет понимание, модификацию и верификацию кода. В то же время последовательная матричная нотация учитывающая инваринтность геометрических объектов относительно выбора базиса позволяет корректно выражать геометрические идеи и упрощать понимание программного кода, а так же транслировать формулы линейной алгебры в код.

\section{Соглашения относительно нотации}
Матрица размера $m \times n$ есть двумерный массив или отображение $\{ 1, \dots, m \} \times \{ 1, \dots, n \} \to \mathbb R$. Номер строки есть первый индекс, столбца -- второй. Элемент матрицы $M$ на пересечении $i$-ой строки и $j$-ого столбца есть $M(i, j)$. Вектор-столбец есть матрица вида $n \times 1$, вектор-строка -- матрица $1 \times n$. Мы придерживаемся соглашения: координатные векторы есть вектор-столбцы. Это означает, что координатный вектор умножается на матрицу всегда слева и  произведение $M \cdot v$ определяется как линейная комбинация столбцов $M$ с коэффициентами - координатами $v$. Если матрица рассматривается как набор вектор-столбцов, то столбец с номером $j$ обозначается $[ M ]_j$. Строка с номером $i$ обозначается $[M]^i$.


\section{Векторное пространство}
Геометрические вычисления проводятся в координатном пространстве $\mathbb R^n$. Мы различаем координатные векторы -- элементы пространства $\mathbb R^n$ -- и геометрические векторы. Геометрический вектор требует указания базиса, относительно которого он представляется данным координатным вектором. Базис из $n$ координатных векторов может быть представлен обратимой $n \times n$ матрицей $U$. При таких соглашениях геометрический вектор есть пара $(U, v)$, где $U$ - матрица, $v$ - координатный вектор.

Пространство $\mathbb R^n$ обладает стандартным базисом
$$
\left(
\begin{array}{c}
1 \\
0 \\
\vdots \\
0 \\
\end{array}
\right),
\left(
\begin{array}{c}
0 \\
1 \\
\vdots \\
0 \\
\end{array}
\right),
\dots,
\left(
\begin{array}{c}
0 \\
0 \\
\vdots \\
1 \\
\end{array}
\right),
$$
представляемым единичной матрицей. Относительно этого базиса геометрический вектор совпадает с координатным.

Основное соотношение между геометрическим $\mathbf v$ и координатным $v$ векторами, остающееся инвариантным при замене базиса,
$$
\mathbf v = U \cdot v.
$$
Матрица $U$ в таком представлении интерпретируется как набор координатных векторов относительно стандартного базиса если нет явного указания иного базиса.


\subsection{Преобразование базиса}
Пусть даны два базиса $U$ и $U'$. Представим каждый вектор базиса $U'$ в виде линейной комбинации векторов базиса $U$
$$
[U']_j = [U]_1 t^1_j + \ldots + [U]_n t^n_j, \quad j = 1, \ldots, n.
$$
Умножение матрицы слева на вектор равносильно образованию линейной комбинации столбцов матрицы с координатами вектора в качестве коэффициентов. Этот факт позволяет объединить $n$ равенств в одно матричное
$$
U' = U \cdot T,
$$
где столбцы матрицы $T$ образованы коэффициентами линейных комбинаций. Матрица $T$ очевидно обратима. Распространяя это рассуждение на цепочку из трех базисов $U$, $U'$ и $U''$ находим
$$
U'' = U' \cdot T' = U \cdot T \cdot T'.
$$ 



\subsection{Преобразование координат}
Рассмотрим как преобразуются координаты геометрического вектора $\mathbf v$ при замене базиса. Пусть $v$ -- его координаты относительно $U$, $v'$ -- относительно $U'$
$$
\mathbf v = U \cdot v = U \cdot T \cdot T^{-1} \cdot v = \cdot U' \cdot T^{-1} \cdot v = U' \cdot v'
$$
Таким образом относительно базиса $U'$ вектор $\mathbf v$ имеет координаты $v' = T^{-1} \cdot v$. Иначе это можно записать так $v = T \cdot v'$. Для цепочки из трех базисов получаем
$$
v'' = T'^{-1} \cdot v' = T'^{-1} \cdot T^{-1} \cdot v = (T \cdot T')^{-1} \cdot v
$$
или $v = T \cdot T' \cdot v''$.


\subsection{Преобразование матриц отображений}

Матрицы линейных отображений также зависят от выбранного базиса. Относительно базиса $U$ матрица преобразования координат $M$ действует на геометрический вектор $\mathbf v$ следующим образом
$$
\mathbf v = U \cdot v \mapsto U \cdot M v.
$$
Относительно базиса $U' = U \cdot T$ можно записать
$$
\mathbf v = U \cdot v = U' \cdot v' \mapsto U \cdot M v = U' \cdot T^{-1} \cdot M \cdot T \cdot v'.
$$
Отсюда матрица отображения относительно $U'$ есть $T^{-1} \cdot M \cdot T$.


\subsection{Дерево базисов}

Рассмотрим более сложную ситуацию корневого дерева, в каждой вершине которого задан базис. Дерево предполагается ориентированным от корня к листьм. Если существует путь от вершины $s$ к вершине $s'$, согласованный с ориентацией дерева, $s'$ называется потомком  $s$. Этот факт обозначается так $s' \gg s$. Если путь состоит из двух вершин $s, s'$, то $s'$ называется непосредственным потомком $s$ и обозначается $s' > s$. Базис, соотнесенный вершине $s$, обозначается $U_s$.

Если $s' > s$, базисы $U_{s'}$ и $U_s$ связаны матрицей перехода $T^s_{s'}$
$$
U_{s'} = U_s \cdot T^s_{s'}.
$$
Применяя последовательно это правило к вершинам $s' \gg s$ находим
\begin{align*}
U_{s_1} &= U_s, \\
U_{s_2} &= U_{s_1} \cdot T^{s_1}_{s_2}, \\
U_{s_3} &= U_{s_2} \cdot T^{s_2}_{s_3} = U_{s_1} \cdot T^{s_1}_{s_2} \cdot T^{s_2}_{s_3} , \\
\cdots \\
U_{s_n} &= U_{s'} = U_{s_{n-1}} \cdot T^{s_{n-1}}_{s_n} = U_{s_{n-2}} \cdot T^{s_{n-2}}_{s_{n-1}} \cdot T^{s_{n-1}}_{s_n} \\
&= U_{s_1} \cdot  T^{s_1}_{s_2} \cdot T^{s_2}_{s_3} \cdot \ldots \cdot T^{s_{n-2}}_{s_{n-1}} \cdot T^{s_{n-1}}_{s_n}
\end{align*}
где $(s = s_1, s_2, \ldots, s_n = s')$ есть ориентированный путь от $s$ к $s'$. Иными словами, при спуске вниз по дереву от $s$ к $s'$ происходит домножение текущей матрицы перехода справа на очередную матрицу перехода между соседними вершинами.


\section{Аффинные пространства}
Для применения матричной алгебры к аффинному пространству $\mathbb R^n$ вложим его как аффинную гиперплоскость в $\mathbb R^{n+1}$. Иными словами, отождествим $\mathbb R^n$ с аффинной гиперплоскостью $x_{n+1} = 1$, а ассоциированное векторное пространство отождествим с векторной гиперплоскостью $x_{n+1} = 0$. В стандартном базисе $\mathbb R^{n+1}$ точки из $\mathbb R^n$ представляются столбцом 
$$
\left(
\begin{array}{c}
x_1 \\
x_2 \\
\vdots \\
x_n \\
1 \\
\end{array}
\right),
$$
а векторы из $\mathbb R^n$ представляются столбцом
$$
\left(
\begin{array}{c}
x_1 \\
x_2 \\
\vdots \\
x_n \\
0 \\
\end{array}
\right).
$$
Здесь $x_1, x_2, \dots, x_n$ -- произвольные числа.

\makeatletter
\renewcommand{\@biblabel}[1]{#1.\hfill}
\makeatother

\begin{thebibliography}{99}
\bibitem{vinberg}Э.~Б.~Винберг. Курс алгебры.
\bibitem{maltsev}А.~И.~Мальцев. Основы линейной алгебры.
\bibitem{ershov}А.~В.~Ершов. Линейные и аффинные пространства и отображения.
\bibitem{anosov}Д.~В.~Аносов. Лекции по линейной алгебре.
\end{thebibliography}




\end{document}
